---
import { getCollection } from "astro:content";

const pathname = Astro.url.pathname;

const writingPosts = await getCollection("writing");
const readingPosts = await getCollection("reading");

const allPosts = [...writingPosts, ...readingPosts].filter(
  (post) => post.data.public,
);

const tags = [...new Set(allPosts.map((post) => post.data.tags || []).flat())]
  .map((tag) => tag.trim().toLowerCase())
  .map((tag) => {
    return {
      text: tag,
      url: `/tags/${tag}`,
    };
  });
---

<ul class="menu menu-horizontal rounded-box">
  {
    tags.map((tag) => (
      <li>
        <a class="" href={tag.url || ""}>
          {tag.text || ""}
        </a>
      </li>
    ))
  }
  {
    pathname !== "/tags" ? (
      <li>
        <a class="" href="/tags">
          所有标签…
        </a>
      </li>
    ) : (
      ""
    )
  }
</ul>
